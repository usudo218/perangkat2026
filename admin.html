function loadData() {
        const tbody = document.querySelector('#dataTable tbody');
        const status = document.getElementById('statusMsg');
        const filter = document.getElementById('filterKelas').value;

        tbody.innerHTML = ''; 
        status.style.display = 'block';
        status.innerHTML = "Sedang menghubungi Server Google... ⏳";

        // Tambahkan parameter ?action=read agar URL terlihat unik (trik bypass cache)
        fetch(SCRIPT_URL + "?action=read")
        .then(res => {
            if (!res.ok) { throw new Error("Gagal Akses (Cek Izin 'Anyone')"); }
            return res.text(); // Kita ambil Text dulu, jangan langsung JSON
        })
        .then(text => {
            let response;
            try {
                response = JSON.parse(text); // Baru kita ubah ke JSON manual
            } catch (e) {
                throw new Error("Data rusak (Bukan JSON). Cek Nama Sheet di Excel!");
            }

            status.style.display = 'none'; 
            
            if(response.status === 'success') {
                let data = response.data;
                
                // --- LOGIKA MENAMPILKAN DATA (SAMA SEPERTI SEBELUMNYA) ---
                if(filter !== 'ALL') {
                    data = data.filter(row => row.kelas === filter);
                }

                if(data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">Data kosong.</td></tr>';
                    return;
                }

                data.forEach(row => {
                    let tr = document.createElement('tr');
                    let dateStr = new Date(row.timestamp).toLocaleString('id-ID');
                    
                    let displayJawaban = "";
                    try {
                        let jObj = JSON.parse(row.jawaban);
                        displayJawaban = Object.entries(jObj)
                            .map(([k, v]) => `<b>${k}:</b> ${v}`).join("<br>"); 
                    } catch(e) { displayJawaban = row.jawaban; }

                    tr.innerHTML = `
                        <td><small>${dateStr}</small></td>
                        <td><span class="badge">${row.kode}</span></td>
                        <td><strong>${row.nama}</strong></td>
                        <td>${row.kelas}</td>
                        <td style="font-size:0.85em;">${displayJawaban}</td>
                    `;
                    tbody.appendChild(tr);
                });
                // ---------------------------------------------------------

            } else {
                status.style.display = 'block';
                status.innerHTML = "Error Script: " + response.error;
            }
        })
        .catch(err => {
            console.error(err);
            status.style.display = 'block';
            status.innerHTML = "❌ GAGAL: " + err.message;
            alert("Gagal terhubung!\n\nPastikan Deployment Apps Script aksesnya: 'Siapa Saja (Anyone)'");
        });
    }
